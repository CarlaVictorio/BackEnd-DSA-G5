<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>LogIn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        body {
            background-image: url('fondo.png');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: 100% 100%;
        }
        h2{
            background-color:rgb(236, 132, 27, 0.7);
        }

    </style>
    <script>

    function addCardIngrediente(name, nivel, precio){
        var res ="<div class='col-sm-4'>\n"+
                    "<div class='card' style='width:400px; background-color:rgb(236, 132, 27, 0.7)'>\n"+
                    "<img class='card-img-top' src='ingredientesUtensilios/"+name+".jpg' alt='Card image' style='width:100%'>\n"+
                    "<div class='card-body'>\n"+
                        "<h4 class='card-title'>"+name+"</h4>\n"+
                        "<p class='card-text'>Nivel de desbloqueo: "+nivel+"</p>\n"+
                        "<p class='card-text'>Precio: "+precio+"</p>\n"+
                        "<a href='#' class='btn btn-primary' id='"+name+"'>Comprar</a>\n"+
                    "</div></div></div>";
        return res;
    }
    function addCardUtensilio(name, nivel1, nivel2, nivel3){
        var res ="<div class='col-sm-4'>\n"+
                    "<div class='card' style='width:400px; background-color:rgb(236, 132, 27, 0.7)'>\n"+
                    "<img class='card-img-top' src='ingredientesUtensilios/"+name+".jpg' alt='Card image' style='width:100%'>\n"+
                    "<div class='card-body'>\n"+
                        "<h4 class='card-title'>"+name+"</h4>\n"+
                        "<p class='card-text'>Nivel 1: "+nivel1+"</p>\n"+
                        "<p class='card-text'>Nivel 2: "+nivel2+"</p>\n"+
                        "<p class='card-text'>Nivel 3: "+nivel3+"</p>\n"+
                        "<a href='#' class='btn btn-primary' id='"+name+"'>Comprar</a>\n"+
                    "</div></div></div>";
        return res;
    }

    $(document).ready(function(){

        var jugador = localStorage.getItem('Nombre');
        console.log(usuario);
        if (usuario == null) {
            location.href = "/logIn.html"
        }
        var x = 0;
        var contarFins3 = 0;
        var res = "";
        var idJugador = "";
        var idIngrediente = "";

        var url = "/dsaApp/Jugador/getJugadorByNombre/"+jugador;
        $.get(url, function (data, status){
            var idJugador = data.idJugador;
        });

        var url = "/dsaApp/ingrediente/getAllIngredientes";
        $.get(url, function (data, status){
                $.each (data, function(index, data){
                   console.log(x);
                    if (x%3==0){
                        res = res + "<div class='row'>\n";
                    }
                    console.log(data.nombreIngrediente, data.nivelDesbloqueoIngrediente, data.precioIngrediente);
                    res = res + addCardIngrediente(data.nombreIngrediente, data.nivelDesbloqueoIngrediente, data.precioIngrediente);
                    contarFins3 = contarFins3 + 1;
                    if (contarFins3 == 3){
                        res = res + "</div>";
                        contarFins3 = 0;
                    }
                    console.log("\n", res);
                    x=x+1;

                    $('#'+data.nombreIngrediente).click(function() {
                        var url = "/dsaApp/ingrediente/getIngredienteByNombre/"+data.nombreIngrediente;
                        $.get(url, function (data, status){
                            var idIngrediente = data.idIngrediente;
                        });
                        /*
                        var dataBody=
                        {
                            idIngrediente: idIngrediente,
                            idJugador: idJugador,
                        }
                        var URL = "/dsaApp/ingrediente/Login";
                        $.post(
                        {
                            url: URL,
                            data: JSON.stringify(dataBody),
                            contentType: 'application/json; charset=utf-8'
                        })
                            .done(function(data, status){
                                var index = "index.html";
                                localStorage.setItem('Nombre',$("#userLogIn").val())
                                $(location).attr('href',index);
                            })
                            .fail(function(xhr, err){
                                alert("Usuario o contrase√±a incorrectos");
                                location.reload();
                            })
                          */
                    });
                });
                if (contarFins3 != 3){
                    res = res + "</div>";
                }
                console.log("\n", res);
                $("#containerIngredientes").append(res);
        });

        var x = 0;
        var contarFins3 = 0;
        var res = "";
        var url = "/dsaApp/utensilio/getAllUtensilios/";
        $.get(url, function (data, status) {
                $.each (data, function(index, data){
                    console.log(x);
                    if (x%3==0){
                        res = res + "<div class='row'>\n";
                    }
                    console.log("utensilio!!!!",utensilio);
                    res = res + addCardUtensilio(data.nombreUtensilio, data.tiempoNivel1, data.tiempoNivel2, data.tiempoNivel3);
                    contarFins3 = contarFins3 + 1;
                    if (contarFins3 == 3){
                        res = res + "</div>";
                        contarFins3 = 0;
                    }
                    console.log("\n", res);
                    x=x+1;
                });
                if (contarFins3 != 3){
                    res = res + "</div>";
                }
                console.log("\n", res);
                $("#containerUtensilios").append(res);
        });
    });
    </script>
</head>
<body>
    <div class="jumbotron text-center"style="background-color:rgb(236, 132, 27, 0.7)">
        <h1>Llista d'objectes</h1>
    </div>

    <div class="container-fluid" id="containerIngredientes">
        <h2>Ingredientes</h2>
    </div>

    <div class="container-fluid" id="containerUtensilios">
        <h2>Utensilios</h2>
    </div>
</body>
</html>